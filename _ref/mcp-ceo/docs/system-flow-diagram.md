# FlowMind System Flow Diagram
*Boot vs Runtime Architecture with Bidirectional MCP Flow*

## üöÄ BOOT PHASE (System Initialization)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                           BOOT PHASE                           ‚îÇ
‚îÇ                    (One-time Compilation)                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

üìÅ YAML Context Files
‚îú‚îÄ‚îÄ contexts/agents/ceo/context.yaml
‚îú‚îÄ‚îÄ contexts/workflows/document-synthesis/context.yaml  
‚îú‚îÄ‚îÄ contexts/patterns/echo-intelligence/context.yaml
‚îú‚îÄ‚îÄ contexts/types/workspace/context.yaml
‚îî‚îÄ‚îÄ contexts/agents/eeps/nfj-visionary/context.yaml
           ‚îÇ
           ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ ContextRegistry ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ - Scan contexts ‚îÇ     ‚îÇ
    ‚îÇ - Build catalog ‚îÇ     ‚îÇ
    ‚îÇ - Map types     ‚îÇ     ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îÇ
           ‚îÇ                ‚îÇ
           ‚ñº                ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îÇ
    ‚îÇ ContextAssembler‚îÇ     ‚îÇ 
    ‚îÇ - Load contexts ‚îÇ     ‚îÇ
    ‚îÇ - Create FlowMind‚îÇ    ‚îÇ
    ‚îÇ - Validate YAML ‚îÇ     ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îÇ
           ‚îÇ                ‚îÇ
           ‚ñº                ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îÇ
    ‚îÇ   FlowMind      ‚îÇ ‚óÑ‚îÄ‚îÄ‚îÄ‚îò
    ‚îÇ - 1:1 YAML map  ‚îÇ
    ‚îÇ - Type checking ‚îÇ
    ‚îÇ - Validation    ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ  Boot Registry  ‚îÇ
    ‚îÇ - Cache loaded  ‚îÇ
    ‚îÇ - Index by URI  ‚îÇ 
    ‚îÇ - Ready state   ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Boot Components:**
- **ContextRegistry**: Discovers all `.yaml` files, catalogs by type
- **ContextAssembler**: Loads YAML ‚Üí FlowMind instances  
- **FlowMind**: Universal context wrapper with validation
- **Boot Registry**: In-memory cache of all loaded contexts

---

## ‚ö° RUNTIME PHASE (Request Processing)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                         RUNTIME PHASE                          ‚îÇ
‚îÇ                   (Per-Request Processing)                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

üåê MCP Request: execute_workflow('deep_analysis', { data })
           ‚îÇ
           ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ   MCP Server    ‚îÇ
    ‚îÇ - Parse request ‚îÇ
    ‚îÇ - Route to flow ‚îÇ 
    ‚îÇ - Session mgmt  ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ Protocol Router ‚îÇ ‚îÄ‚îÄ‚Üí ‚îÇ  Boot Registry  ‚îÇ
    ‚îÇ - Resolve URI   ‚îÇ     ‚îÇ - Lookup cache  ‚îÇ
    ‚îÇ - Create recipe ‚îÇ     ‚îÇ - Get contexts  ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ                         ‚îÇ
           ‚ñº                         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê              ‚îÇ
    ‚îÇ Recipe Builder  ‚îÇ ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚îÇ - Define sources‚îÇ
    ‚îÇ - Set priorities‚îÇ
    ‚îÇ - Token limits  ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ Assembly Engine ‚îÇ
    ‚îÇ (assembly-rules)‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîÑ BIDIRECTIONAL MCP FLOW (The Magic Loop)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    BIDIRECTIONAL FLOW LOOP                     ‚îÇ
‚îÇ            (Where Intelligence Actually Happens)               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

USER: "Analyze this complex business scenario"
  ‚îÇ
  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   MCP Server    ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ 1. Route Request
‚îÇ server.js       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
  ‚îÇ
  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Assembly Engine ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ 2. Build Context Recipe
‚îÇ assembly-rules  ‚îÇ      - Relevance Filter
‚îÇ                 ‚îÇ      - Priority Rules  
‚îÇ                 ‚îÇ      - Conflict Resolution
‚îÇ                 ‚îÇ      - Token Optimization
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
  ‚îÇ
  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Context Recipe  ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ 3. Select Contexts
‚îÇ { sources: [    ‚îÇ      recipe = {
‚îÇ   "ceo",        ‚îÇ        sources: ["ceo", "nfj-visionary"],
‚îÇ   "nfj-vision"  ‚îÇ        stageConfig: { lead: "ceo" },
‚îÇ ]}              ‚îÇ        tokenLimit: 4000
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      }
  ‚îÇ
  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  LLM (Claude)   ‚îÇ ‚óÑ‚îÄ‚îÄ‚îÄ 4. Context Switch: "You are CEO"
‚îÇ                 ‚îÇ      System: CEO philosophy + instructions
‚îÇ REASONING AS    ‚îÇ      User: Business scenario analysis
‚îÇ CEO PERSONALITY ‚îÇ      
‚îÇ                 ‚îÇ      
‚îÇ - Strategic view‚îÇ      üß† MAXIMUM REASONING POWER
‚îÇ - Risk analysis ‚îÇ         as CEO perspective
‚îÇ - Decision logic‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
  ‚îÇ
  ‚ñº CEO Analysis Complete
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   MCP Server    ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ 5. Context Switch Decision
‚îÇ                 ‚îÇ      "Need visionary perspective"
‚îÇ DECISION:       ‚îÇ      
‚îÇ "Get NFJ input" ‚îÇ      
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
  ‚îÇ
  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Assembly Engine ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ 6. NEW Recipe for NFJ
‚îÇ                 ‚îÇ      recipe = {
‚îÇ NEW CONTEXT     ‚îÇ        sources: ["nfj-visionary"],  
‚îÇ ASSEMBLY        ‚îÇ        focus: "future_possibilities",
‚îÇ                 ‚îÇ        tokenLimit: 2000
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      }
  ‚îÇ
  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  LLM (Claude)   ‚îÇ ‚óÑ‚îÄ‚îÄ‚îÄ 7. Context Switch: "You are NFJ-Visionary"
‚îÇ                 ‚îÇ      System: NFJ psychology + philosophy
‚îÇ REASONING AS    ‚îÇ      User: CEO's analysis + vision request
‚îÇ NFJ-VISIONARY   ‚îÇ
‚îÇ                 ‚îÇ      üåü MAXIMUM REASONING POWER
‚îÇ - Future vision ‚îÇ         as NFJ-Visionary perspective
‚îÇ - Possibility   ‚îÇ
‚îÇ - Innovation    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
  ‚îÇ
  ‚ñº NFJ Analysis Complete
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   MCP Server    ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ 8. Synthesis Decision
‚îÇ                 ‚îÇ      "Combine perspectives"
‚îÇ SYNTHESIS:      ‚îÇ
‚îÇ "Merge insights"‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
  ‚îÇ
  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Assembly Engine ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ 9. SYNTHESIS Recipe
‚îÇ                 ‚îÇ      recipe = {
‚îÇ CONFLICT        ‚îÇ        sources: ["ceo", "nfj-visionary"],
‚îÇ RESOLUTION      ‚îÇ        mode: "synthesis",
‚îÇ                 ‚îÇ        strategy: "weighted_merge"
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      }
  ‚îÇ
  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  LLM (Claude)   ‚îÇ ‚óÑ‚îÄ‚îÄ‚îÄ 10. Context Switch: "You are Synthesizer"
‚îÇ                 ‚îÇ       System: Both perspectives + synthesis instructions
‚îÇ REASONING AS    ‚îÇ       User: Create unified recommendation
‚îÇ SYNTHESIZER     ‚îÇ
‚îÇ                 ‚îÇ       üéØ MAXIMUM REASONING POWER
‚îÇ - Balance views ‚îÇ          for final synthesis
‚îÇ - Find harmony  ‚îÇ
‚îÇ - Action plan   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
  ‚îÇ
  ‚ñº Final Analysis
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ     USER        ‚îÇ ‚óÑ‚îÄ‚îÄ‚îÄ 11. Return Complete Analysis
‚îÇ                 ‚îÇ       "Strategic business recommendation that balances
‚îÇ GETS EMERGENT   ‚îÇ        CEO risk analysis with NFJ future vision"
‚îÇ INTELLIGENCE    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

TOTAL INTELLIGENCE = CEO + NFJ + SYNTHESIS > Individual perspectives
```

---

## üîç RELEVANCE FILTER PURPOSE

**What It's Supposed To Do:**
```javascript
// CURRENT: Mock semantic relevance (BROKEN)
async filterByRelevance(contexts, currentTask) {
  // ‚ùå Fake embedding similarity
  const relevance = await this.calculateSemanticRelevance(text, taskEmbedding)
  
  // ‚úÖ Real temporal decay (works)
  relevance *= this.applyTemporalDecay(context.timestamp)
  
  // ‚úÖ Real boost rules (works)  
  relevance *= this.applyBoostRules(context, currentTask)
}
```

**Purpose**: Filter from 50+ available contexts ‚Üí 3-5 most relevant for current task

**Real-World Example:**
```
Available: [ceo, nfj-visionary, dev, doc-shepherd, technical-writer, ...]
Task: "Write API documentation"  
Relevance Filter Result: [doc-shepherd, technical-writer, dev]
```

**What We Should Replace Mock With:**
```javascript
// v0.1.0: Simple keyword/type matching (no embeddings)
filterByRelevance(contexts, currentTask) {
  return contexts.filter(context => {
    // Keyword relevance
    const keywords = currentTask.keywords || []
    const hasKeywords = keywords.some(k => 
      context.text.toLowerCase().includes(k.toLowerCase())
    )
    
    // Type preferences
    const typeMatch = currentTask.preferred_types?.includes(context.type)
    
    // Always include high priority
    const highPriority = context.effectivePriority >= 90
    
    return hasKeywords || typeMatch || highPriority
  })
}
```

---

## üìä FILE RESPONSIBILITIES

### Boot Phase
- **ContextRegistry** (`context-registry.js`): Scan file system, build catalog
- **ContextAssembler** (`context-assembler.js`): Load YAML ‚Üí FlowMind instances
- **FlowMind** (`flowmind.js`): Universal context wrapper

### Runtime Phase  
- **MCP Server** (`server.js` pattern): Route requests, manage sessions
- **AssemblyRules** (`assembly-rules.js`): Build context recipes
- **ContextTracker** (`context-tracker.js`): Track context lineage

### Bidirectional Flow
- **Protocol Router**: Resolve URIs to recipes
- **Recipe Builder**: Define context assembly instructions
- **Assembly Engine**: Execute priority/conflict/token rules
- **Context Switching**: LLM embodies different perspectives

---

## üéØ KEY INSIGHTS

**1. Intelligence Through Context Switching**
- Each context switch = new LLM personality
- Multiple perspectives ‚Üí emergent intelligence
- No "AI" in the code - LLM IS the intelligence

**2. Assembly Rules = Context Selection**
- Not semantic evaluation - just smart filtering
- Priority + relevance + conflict resolution
- Prepares contexts for LLM reasoning

**3. Boot vs Runtime Separation**
- Boot: Load and validate all contexts once
- Runtime: Fast lookup and assembly per request
- No file I/O during request processing

**4. MCP = Orchestration Protocol**
- Bidirectional flow enables context switching
- Each MCP call can trigger new context assembly
- Creates recursive intelligence loops

Sound good? This shows the hexagonal architecture with MCP as one adapter, and how the bidirectional flow creates emergent intelligence through systematic context switching.