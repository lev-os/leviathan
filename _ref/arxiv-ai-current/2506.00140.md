## **Balancing Profit and Fairness in Risk-Based Pricing Markets**

**Jesse Thibodeau** [1] **, Hadi Nekoei** [1,2] **, Afaf Ta¨ık** [1,2] **, Janarthanan Rajendran** [3] **, Golnoosh Farnadi** [1,4]

1 Mila - Qu´ebec AI Institute
2 Universit´e de Montr´eal
3 Dalhousie University
4 McGill University
_{_ jesse.thibodeau, nekoeihe, afaf.taik, farnadig _}_ @mila.quebec
janarthanan.rajendran@dal.ca


**Abstract**

Dynamic, risk-based pricing can systematically exclude vulnerable consumer groups from essential resources such as
health insurance and consumer credit. We show that a regulator can realign private incentives with social objectives
through a learned, interpretable tax schedule. First, we provide a formal proposition that bounding each firm’s _local_
demographic gap implicitly bounds the _global_ opt-out disparity, motivating firm-level penalties. Building on this insight we introduce MarketSim—an open-source, scalable
simulator of heterogeneous consumers and profit-maximizing
firms—and train a reinforcement learning (RL) social planner (SP) that selects a bracketed fairness-tax while remaining
close to a simple linear prior via an _ℓ_ 1 regularizer. The learned
policy is thus both transparent and easily interpretable. In two
empirically calibrated markets, i.e., U.S. health-insurance and
consumer-credit, our planner simultaneously raises demandfairness by up to 16% relative to unregulated Free Market
while outperforming a fixed linear schedule in terms of social
welfare without explicit coordination. These results illustrate
how AI-assisted regulation can convert a competitive social
dilemma into a win–win equilibrium, providing a principled
and practical framework for fairness-aware market oversight.

**1** **Introduction**

Firms equipped with modern computational power and extensive consumer data logs may reap financial gains by
adopting dynamic (or personalized) pricing, which tailors
prices to potential customers or customer segments based
on their estimated willingness-to-pay. This approach enables firms to extract the greatest economic value from consumer data. From an efficiency perspective, dynamic pricing has been shown to boost firm profitability and accelerate sales speeds (Schlosser and Boissier 2018; Wang et al.
2023). However, its welfare implications are less consistent. In some markets, including insurance and lending,
dynamic pricing can yield undesirable distributional outcomes (Zhu et al. 2023; Betancourt et al. 2022). For instance, while health insurers often rely on dynamic pricing,
recent census data indicate that members of the Hispanic
population in the U.S. are, on average, roughly twice as unlikely to have healthcare coverage as members of the Afrodescendent population, who in turn are twice as unlikely as
members of the Caucasian and Asian populations (Martinez
2022; Keisler-Starkey, Bunch, and Lindstrom 2024). Simi

Figure 1: Percentage of working-age adults without health
insurance in 2023, by race and income.

Beyond this, substantial price discrepancies between
consumers may also give rise to perceptions of unfairness (Lee, Illia, and Lawson-Body 2011), potentially
discouraging market participation and perpetuating existing
disparities. Moreover, in markets where personal assets can
be leveraged to negotiate more favourable terms, goods may
become _relatively_ more affordable for higher-income consumers. In such scenarios, scarce goods tend to be allocated
to privileged groups, leaving fewer units—or lower-quality
alternatives—to those with fewer resources. This pattern is
well documented in the lending market, where it amplifies
wealth gaps (for example, through restricted access to home
equity) and drives gentrification. Similar issues arise in
sectors such as education services and public transportation,
where buyer distributions should ideally reflect those of the
underlying population.

Dynamic pricing typically enables firms to set prices
for different consumer segments in order to maximize the
expected profits derived from each. Thus, a firm adopting
dynamic pricing rarely accounts for its resulting buyer
distribution, which can be considered unfair if it diverges
too sharply from that of the broader population. In this


larly, data reveal a negative correlation between likelihood
of coverage and income, and since income and ethnicity
are themselves correlated, there are justifiable concerns that
healthcare coverage may be systemically biased.


**Race & Hispanic Origin**


**Income**









study, we explore the challenge of dynamic pricing, and
specifically that of _regulating its use under demand fairness_
_criteria_ in markets where buyer distributions should mirror
those of the underlying population. Motivating this, we
first demonstrate how profit-maximizing price allocations
fail to satisfy demand fairness under purely competitive
or collusive dynamics. Broadly, we recognize that it is
unrealistic to expect a profit-maximizing firm to voluntarily
consider fairness notions in its pricing strategy. Therefore,
we consider how a benevolent social planner (SP) might use
policy tools such as taxation to encourage market participation among underrepresented consumer groups and penalize
unfair firm behavior. To achieve this, we use reinforcement
learning to train an SP capable of devising financial incentives that promote demand fairness—namely, by shrinking
market opt-out disparities between population subgroups.
To conduct our experiments, we introduce MarketSim,
a simple yet robust and scalable simulation framework
wherein arbitrarily many firms engage in price Free Market
to capture a market of arbitrarily many consumer profiles
with heterogeneous utility. **Our findings indicate that**
**social welfare can be enhanced by taxing firms in ways**
**that incentivize fairer market-specific conduct** . Further,
by endowing the learning agent with a domain-specific
prior, we observe that interpretability can be maintained
at the policy level, confirming the effectiveness of our
approach at solving specific markets while retaining certain
desirable properties such as tax monotonicity. Contributions
of our work include:

 - A formal demonstration of how local, firm-level incentives can satisfy a global fairness criterion and thereby
raise social welfare in a setting of multiple self-interested
stakeholders with incomplete information.

 - The introduction of MarketSim, a robust and easy-touse open-source simulator for experimenting with various market dynamics and regulatory policies imposed on
arbitrarily many heterogeneous firms and consumers, and
evaluating their welfare implications. [1]

 - An application of reinforcement learning to generate
optimal regulatory policies in two different instances
of MarketSim (replicating the markets for insurance
and consumer credit), showing that we can incentivize
welfare-improving firm behaviour in each market, while
retaining policy interpretability.

**2** **Related Work**

The interdisciplinary nature of this work requires a review
of topics from economics, specifically in the subfields of
welfare economics and consumer choice theory, as well as a
broad overview of applications of artificial intelligence (AI)
to welfare economics.

**2.1** **Economics Foundations**

In this work, we explore consumer choice and pricing dynamics in competitive markets with heterogeneous agents.

1 Code will be made publicly available upon acceptance of this
work.


On the demand side, consumers exhibit varying sensitivities
to price fluctuations, while on the supply side, firms face heterogeneous marginal costs that proxy for technological and
scale advantages. Our demand system borrows the randomutility framework of Berry, Levinsohn, and Pakes (1993), yet
departs from it in two key respects: first, we replace perfectly
rational choice with a stochastic rule that captures bounded
rationality and behavioural noise; second, we model multiple competing firms rather than a representative producer,
thereby enabling firm-level strategic interaction. These extensions link our analysis to early work on preference heterogeneity by Becker (1962) and its discrete-choice formalisation by McFadden (1972), whose insights remain central
to modern consumer-choice theory (Ben-Akiva et al. 2002).
Finally, following the process-based welfare view of Fleurbaey (2008), we evaluate outcomes not only by efficiency
but also by the fairness of the mechanisms that generate
them, an angle largely absent from the original randomutility literature.

**2.2** **Fairness in Dynamic Pricing**

The welfare-theoretic study of price design has migrated
from economics to operations research (Gallego, Topaloglu
et al. 2019) and computer science (Das et al. 2022), giving rise to a rich taxonomy of fairness definitions. Cohen, Elmachtoub, and Lei (2022) prove that price, demand,
consumer-surplus, and no-purchase fairness cannot be simultaneously satisfied in dynamic settings; we therefore
adopt _demand fairness_ (Cohen, Elmachtoub, and Lei 2022;
Kallus and Zhou 2021), which directly measures disparate
impact on group participation and is well motivated in education, consumer credit and healthcare domains. Alternative
notions such as proportional fairness (Bertsimas, Farias, and
Trichakis 2011) highlight welfare trade-offs but do not readily extend to sequential, multi-firm games. RL approaches
such as Maestre et al. (2019) impose fairness via Jain’s index
under monopoly; in contrast, our regulator shapes _compet-_
_itive_ firms’ incentives so that they voluntarily choose fairer
prices, thereby filling the gap between single-seller RL treatments and static constrained-optimisation models.

**2.3** **AI for Economic Policy Generation**

The closest application to our work combining economic
simulations and sequential modelling is the AI Economist
(Zheng et al. 2020), where agents interact in a simulated
gather-build-trade society, while a social planner aims to
learn an income taxation strategy that improves social welfare, defined as the product of equality and economic productivity. While their work is effective at showcasing emergent behaviours among simulated consumer-workers under
incumbent tax regimes, we introduce a new layer to our exploration which instead focuses on how a dynamic regulator can impact societal outcomes by aligning the objectives
of self-interested firms with its own. Further, our work focuses on markets involving dynamic pricing, where firms
assign prices based on consumer group membership. This
added complexity allows for a deeper analysis of firm responses to incumbent policy frameworks. In addition, we

refer to the safe RL literature to impose domain-specific policy constraints in order to maintain a degree of interpretability, which is critical for the widespread adoption of AIgenerated public policy. In fact, safe RL methods routinely
incorporate domain constraints to ensure an agent’s policy
remains feasible or respects regulatory standards (Garcıa
and Fern´andez 2015). These constraints can be implicit (e.g.,
penalizing the agent for violating constraints) (Achiam et al.
2017). By tethering our AI regulator’s reward function to a
baseline monotonic schedule, we encourage the learned regulatory policy to align with essential policy norms, namely,
that higher fairness should generally not be penalized by
higher tax rates, while preserving the safety and interpretability required in real-world economic regulation.

**3** **Preliminaries**

We provide an overview of notation and definitions referred
to throughout the remainder of this work. Among these, we
refer to local and global notions of fairness within this context. Further, we motivate our policy mechanism design by
demonstrating how local fairness incentives have global fairness implications. Going forward, let _A_ be a random variable representing a consumer profile, taking values in the set
_A_ = _{_ 1 _, . . ., m}_, and let _F_ be a random variable denoting the firm selected by a given consumer, taking values in
_F_ = _{_ 0 _, . . ., n}_, with _F_ = 0 referring to opting out of the
market.

**3.1** **Definitions and Fairness Metrics**

**Definition 1** ( _ϵ_ - **Local Fairness** ) **.** For any firm _j ∈F_, and
for any consumer profile pair _i, k ∈_ _A_, we say that firm _j_ is
_ϵ-locally fair_ if


max
_i,k_


��Pr( _F_ = _j | A_ = _i_ ) _−_ Pr( _F_ = _j | A_ = _k_ )�� _≤_ _ϵ._


_Remark._ When _ϵ_ = 0, it means that every consumer group’s
consumption choice is conditionally independent from their
group membership.

We quantify market-wide fairness via the opt-out disparity
between consumer groups, which we call _global fairness_
in order to relate it to its _local_ counterpart. This definition
draws on _demand fairness_, proposed by Cohen, Miao, and
Wang (2021).

**Definition 2** ( _ϵ_ – **Global Fairness** ) **.** The entire market is
_ϵ–globally fair_ if the _opt-out rate_ is (approximately) profile–independent:


max
_i,k_


Pr( _F_ = 0 _| A_ = _i_ ) _−_ Pr( _F_ = 0 _| A_ = _k_ ) _≤_ _ϵ._
��� ���


_Remark._ When _ϵ_ = 0, every profile opts out with exactly the
same probability, i.e. _Pr_ ( _F_ = 0) is constant in _A_ . This result is akin to demographic parity (Dwork et al. 2012), where
profile _i ⊥⊥_ firm _j_ .

**3.2** **Fairness alignment**

Local and global fairness capture different levels of discrimination, though both measurements have shortcomings


if considered on their own. On one hand, perfect local fairness fails to capture consumer counts, that is, a firm’s consumers can mirror the population while including very few
in total. Similarly, global fairness is satisfied under no market participation, i.e. the case where everyone opts out. Thus,
any policy objective involving global fairness should also include some notion of economic productivity. Further, global
fairness does not imply local fairness and is not directly
addressable. Figure 2 illustrates a market in which _global_
fairness holds—both consumer profiles opt out _∼_ 20 % of
the time—yet the two firms serve very different mixes of
profiles ( _F_ 1 serving _A_ 1 and _F_ 2 serving _A_ 2 ), violating _lo-_
_cal_ fairness. How then can an external regulator, unable to

_F_ 2 _F_ 1 _A_ 1

_F_ 2 _F_ 1 _A_ 2

Figure 2: Perfect global fairness does _not_ imply local fair
ness.

address global fairness explicitly, make global fairness improvements by deploying firm-level incentives? This challenge constitutes a mechanism design problem, which we
formalize as an optimization problem in the following section.

**3.3** **From Local to Global Fairness**

We first show that _enforcing an ϵ–local–fairness constraint_
_on_ each _firm automatically bounds the market-wide opt-out_
_disparity._ The result motivates our policy design: penalties
can be assessed at the firm level, yet they control the global
metric of interest.

**Proposition 1** (Local _⇒_ Global Fairness Bound) **.** _If every_
_firm j ∈{_ 1 _, . . ., n} satisfies the local-fairness condition_

max ��Pr( _F_ = _j | A_ = _i_ ) _−_ Pr( _F_ = _j | A_ = _k_ )�� _≤_ _ϵ,_
_i,k∈A_

_then the market is ε_ _[′]_ _-globally fair, i.e._

��Pr( _F_ = 0 _| A_ = _i_ ) _−_ Pr( _F_ = 0 _| A_ = _k_ )�� _≤_ _ε_ _′_ _∀_ _i, k ∈A,_

_with_
_ε_ _[′]_ = min _{ nϵ,_ 1 _} ._

_Proof._ For brevity write _p_ _j|i_ := Pr( _F_ = _j | A_ = _i_ ). The
hypothesis gives _|p_ _j|i_ _−_ _p_ _j|k_ _| ≤_ _ϵ_ for every firm _j ≥_ 1 and
every pair of profiles _i, k_ .

**From local to opt-out gap.** Because the opt-out probability
is the complement of the in-market mass,


_n_
� _p_ _j|k_ _._

_j_ =1


_p_ 0 _|i_ = 1 _−_

Hence


_n_
� _p_ _j|i_ _,_ _p_ 0 _|k_ = 1 _−_

_j_ =1


_n_
� _|p_ _j|k_ _−_ _p_ _j|i_ _| ≤_ _nϵ._

_j_ =1


_|p_ 0 _|i_ _−_ _p_ 0 _|k_ _|_ =
���


_n_
�( _p_ _j|k_ _−_ _p_ _j|i_ )��� _≤_

_j_ =1

**Probabilistic range.** Because each _p_ 0 _|·_ is a probability, their
difference cannot exceed 1: _|p_ 0 _|i_ _−_ _p_ 0 _|k_ _| ≤_ 1 _._

Combining the two bounds,

_|p_ 0 _|i_ _−_ _p_ 0 _|k_ _| ≤_ min _{ nϵ,_ 1 _},_

which yields the stated _ε_ _[′]_ .

**Policy insight.** Because global fairness follows directly
from firm-level constraints, a regulator can simply penalize firms based on their own _ϵ_ –local gap; no market-wide
coordination term is needed. This concludes the motivation
for our social planner’s policy mechanism. In the following
section, we outline the market environments in which policy
explorations take place.

**4** **Market Environment**

We model an oligopolistic market with heterogeneous consumers and profit-maximizing firms. We then introduce a social planner whose policy consists of a bracketed tax schedule to incentivize fairness. An illustration of this market can
be found in Figure 3. We proceed with formal definitions for
our simulated agents.

**4.1** **Consumers**

Each consumer profile _i_ obtains utility

_U_ _i,j_ = _α −_ _β_ _i_ _p_ _i,j_

from consuming firm _j_ ’s product, where _α_ _j_ is base product utility, _β_ _i_ is the price sensitivity of profile _i_, and _p_ _i,j_ is
the per-profile price. For the outside option _F_ = _j_ = 0,
let _U_ _i,_ 0 = _α_ 0 . A consumer of profile _i_ chooses among
_{_ 0 _, . . ., n}_ with probability


**4.3** **Social Planner and Welfare Maximization**

We now introduce a social planner who aims to maximize
overall _social welfare_, a hybrid measure of fairness and firm
profits. To maintain policy interpretability, we also penalize
large deviations from a simple, _naive_ bracketed-tax baseline.

**Bracketed Fairness Tax.** To incentivize firms to adopt
fairer outcomes, we partition the fairness range [0 _,_ 1] into _B_
brackets, each of width 1 _/B_ . Suppose firm _j_ achieves fairness _f_ _j_ _∈_ [0 _,_ 1] and hence belongs to bracket _b_ _j_, defined
by
_b_ _j_ _−_ 1 _b_ _j_
_f_ _j_ _∈_ _B_ _[,]_ _B_ _._
� �

We index tax brackets by _b ∈{_ 1 _, . . ., B}_ and associate to
each bracket a rate _τ_ _b_ _∈_ [0 _,_ 1]. In general, we collect these
into the vector

_**τ**_ = [ _τ_ 1 _, . . ., τ_ _B_ ] _∈_ [0 _,_ 1] _[B]_ _._

A firm in bracket _b_ _j_ thus faces an effective per-profile margin � _p_ _i,j_ _−mc_ _i,j_ ��1 _−τ_ _b_ _j_ �. Consequently, under regulation,
firm _j_ ’s profit-maximization problem becomes

max �1 _−_ _τ_ _b_ _j_ � _,_ _p_ min _≤_ _p_ _i,j_ _≤_ _p_ max _._
_{p_ _i,j_ _}_ [E][[Π] _[j]_ []]

**Social Welfare Objective.** Let _W_ � _**τ**_ � be the total social
welfare,


1
_W_ � _**τ**_ � = � _n_


_n_
� E[Π _j_ ]�1 _−_ _τ_ _b_ _j_ � [�] _×_ fairness global � _**τ**_ � _,_

_j_ =1


exp� _U_ _i,j_ �
**p** _j|i_ = _n_


_n_
� exp� _U_ _i,j_ � _[.]_

_j_ =0


_n_
�


**4.2** **Firms**

Each firm _j ∈{_ 1 _, . . ., n}_ may compute its expected profit:


E[Π _j_ ] =


_m_
� **p** _j|i_ � _p_ _i,j_ _−_ _mc_ _i,j_ � _,_

_i_ =1


where _mc_ _i,j_ is the average marginal cost for profile _i_ . Under
free-market dynamics, firm _j_ ’s problem is

max subject to 0 _≤_ _p_ _i,j_ _≤_ _p_ max _._
_{p_ _i,j_ _}_ [E][[Π] _[j]_ []]

Due to the inherent jump discontinuities in consumer
choices under Free Market, firms solve for prices using Powell’s derivative-free method (Powell 1964) in the SciPy
Python optimization library (Virtanen et al. 2020). While we
found this to achieve better stability, we note that alternative
optimization methods may be used to solve the firms’ problem.


capturing _both_ global fairness (measured via the gap presented in Definition 2) _and_ net firm profits (under the chosen _**τ**_ ). We note that this multiplicative welfare expression
is one of many possible ways to combine fairness and profit,
however the intuition here is that fairness _∈_ [0 _,_ 1] effectively scales profit. A similar formulation of welfare is used
in (Zheng et al. 2020). The planner’s goal is to select _**τ**_ to
solve max _**τ**_ _W_ � _**τ**_ �. To this end, we use a soft actor-critic algorithm (Haarnoja et al. 2018) to train an RL agent whose
reward is _W_ � _**τ**_ �.
In Algorithm 1, we outline the simultaneous Nash Free Market in which firms select prices to optimize for profit given a
policy generated by the social planner.

**5** **Market Parameterization and Empirical**
**Results**

We consruct two market environments, _health insurance_ and
_consumer lending_, because both combine risk-based pricing with pronounced distributional concerns. Income-group
proportions follow Pew Research Center (2024); insurancecoverage rates draw on Keisler-Starkey, Bunch, and Lindstrom (2024); and home-ownership patterns (a proxy for
credit demand) follow U.S. Census Bureau (2023). The population is divided into High, Middle, and Low income segments, each assigned a price elasticity ( _β_ ) and a firm-specific
marginal cost ( _mc_ ). These parameters, which can be found
for both markets in table 1, introduce system-wide heterogeneity.

Figure 3: A dynamic-pricing market consisting of 3 agent types, each with their own optimization objective. The social planner
generates welfare-maximizing tax schedules applied to firms based on their local fairness gap. Firms then compute their best
responses and assign consumer group-level prices. Finally, consumers make their selection from these prices.


**Why heterogeneity matters.** Heterogeneity arises among
both agent participant types in the market and shapes every
dimension of the policy problem:

 - **Consumers.** Differences in disposable income, outside
options, and risk exposure create a spread of price elasticities. In insurance, demand is relatively inelastic at higher
incomes because coverage quality is valued more than
marginal dollars. In credit, by contrast, wealthier households can leverage their assets to negotiate better terms,
pay cash or source cheaper capital altogether, making
them more price-sensitive. Such a cross-market reversal
broadly illustrates how elasticity is a joint outcome of
preference intensity and available substitutes.

 - **Firms.** Marginal cost is tightly linked to borrowers’ or
policyholders’ income. Low-income consumers are generally riskier to serve as they face higher job volatility, have thinner financial buffers (Bertoletti, Borraz, and
Sanroman 2024; Fout et al. 2020), and—in the case of
health insurance—experience more occupational hazards
and reduced access to preventive care (Nicholson, Bunn,
and Costich 2008). These factors translate into (i) higher
expected claim costs for insurers and (ii) elevated default probabilities for lenders, raising the average perunit cost of coverage or credit. By contrast, high-income
consumers offer steadier cash flows, better health profiles, and superior collateral, enabling firms to price at
lower cost. Even within a single industry, providers differ in their ability to manage this risk—large insurers
leverage pooled data and predictive analytics, whereas
smaller or niche firms often specialize in higher-risk


pools—amplifying cost dispersion and strategic asymmetry.

From a regulatory standpoint, it is important to consider
both sources of heterogeneity in order for policies to achieve
realistic social welfare improvements. Our bracketed tax
is therefore designed to be _piecewise_ —simple enough for
transparency yet flexible enough to align marginal incentives
across diverse firms. We compare three baselines:

 - **Free Market:** Firms compete in a simultaneous pricesetting game with the aim of maximizing their individual
profits in the absence of policy intervention.

 - **Linear regulation:** a monotonic, bracketed linear tax

_b_
_τ_ _b_ [base] = 1 _−_ _B_ _[,]_ for _b_ = 1 _, . . ., B._

intended as a hand-crafted fairness correction. Intuitively,
this baseline approximates a simple rule ( _τ_ = (1 _−_
_fairness_ )), discretized into _B_ brackets.

 - **Collusion:** Firms jointly maximize aggregate profit. This
benchmark reveals the upper bound on total profitability
under perfect coordination, and can be seen as an oracle
case for profit.

For these benchmarks, we report outcomes after convergence to Nash equilibrium prices.

**Demand elasticity.** Elasticity captures both willingness
and ability to substitute. For health insurance, the absence of close substitutes renders wealthier consumers less

Algorithm 1: Multi-Agent Price-Setting Game

1: **Input:**
2: Number of firms _n_ (indexed by _j_ ); consumer profiles
_i_ = 1 _, . . ., m_ with size _S_ _i_ and price sensitivity _β_ _i_ ;
3: Base utility _α_ _j_ for each firm _j_ ; outside option utility

_α_ 0 ;
4: Tax brackets _**τ**_ = [ _τ_ 1 _, . . ., τ_ _B_ ] set by planner;
marginal costs _mc_ _i,j_ .
5: **Initialize:**
6: Each firm _j_ has prices _p_ _i,j_ (possibly random or previously set).

7: **Step 1: Social Planner Sets Tax Policy**
8: **for** _j ←_ 1 to _n_ **do**
9: Compute fairness _f_ _j_ for firm _j_
10: Assign bracket _b_ _j_ _←_ bracket index such that _f_ _j_ _∈_
_b_ _j_ _−_ 1

_B_ _[,]_ _[ b]_ _B_ _[j]_

� �

11: Set effective tax rate _τ_ _b_ _j_ for firm _j_
12: **end for**
13: _▷_ Firm _j_ ’s margin becomes ( _p_ _i,j_ _−_ _mc_ _i,j_ )(1 _−_ _τ_ _b_ _j_ )

14: **Step 2: Firms Simultaneously Update Prices**
15: **for** _j ←_ 1 to _n_ **do**
16: _p_ _i,j_ _←_ arg max _p_ _i,j_ � _mi_ =1 **[p]** _[j][|][i]_ _[ ·]_ [ (] _[p]_ _[i,j]_ _[ −]_ _[mc]_ _[i,j]_ [)(1] _[ −]_
_τ_ _b_ _j_ ) _· S_ _i_
17: _▷_ Firm _j_ chooses prices to maximize expected profit
18: **end for**

19: **Step 3: Consumers Choose Firm or Outside Option**
20: **for** _i ←_ 1 to _m_ **do**
21: **for** _j ←_ 1 to _n_ **do**
22: _U_ _i,j_ _←_ _α_ _j_ _−_ _β_ _i_ _p_ _i,j_
23: **end for**
24: _U_ _i,_ 0 _←_ _α_ 0
25: **p** _j|i_ _←_ exp( _U_ _i,_ 0 )+exp( [�] _U_ _[n]_ _k_ =1 _i,j_ ) [exp(] _[U]_ _[i,k]_ [)] _∀j_

26: **end for**

27: **Step 4: Outcome and Payoffs**
28: **for** _j ←_ 1 to _n_ **do**
29: Demand _i,j_ _←_ _S_ _i_ _·_ **p** _j|i_ _∀i_
30: Π _j_ _←_ [�] _[m]_ _i_ =1 [(] _[p]_ _[i,j]_ _[ −]_ _[mc]_ _[i,j]_ [)(1] _[ −]_ _[τ]_ _[b]_ _j_ [)] _[ ·]_ [ Demand] _[i,j]_
31: **end for**

32: **Step 5: End of Game**
33: Output final _**τ**_, prices _{p_ _i,j_ _}_, demands, and profits
_{_ Π _j_ _}_ .

price-responsive. In credit, abundant alternatives (e.g. homeequity lines, credit cards, or abstention) make the same
group more price-elastic, whereas low-income borrowers
confront a near take-it-or-leave-it contract.

**Marginal cost.** Risk-adjusted cost falls with income in
both markets but for distinct reasons: fewer costly medical
claims in insurance, and lower default probabilities in lending. Firms, heterogeneous in ressources and capability, modulate these costs further.
Finally, the social planner learns a piecewise-constant tax
via Soft Actor–Critic (Table 2). By explicitly targeting cross


_[j]_

_B_
�


**Insurance** **Credit**

**Group** **N** _β_ _mc_ 1 _mc_ 2 _β_ _mc_ 1 _mc_ 2 _mc_ 3 _mc_ 4 _mc_ 5

High (H) 200 0.25 2.50 2.25 3.00 0.40 0.65 0.45 0.60 0.44

Middle (M) 520 0.70 3.00 2.75 2.70 1.20 1.45 1.12 1.35 1.29

Low (L) 280 0.825 3.50 3.25 2.25 2.05 2.30 2.25 2.28 2.10

Table 1: Baseline demand elasticities and marginal costs.
The insurance market is modelled with two competing insurers, and the credit market with five lenders. Price bounds
are _P_ min = 1, _P_ max = 20.

**Shared social-planner parameters**

Algorithm Brackets _B_ _τ_ min _τ_ max _λ_ ins _/λ_ cred

SAC 20 0% 100% 100 / 10

Table 2: Social-planner initialization parameters.

segment disparities, the learned policy reflects heterogeneity
on _both_ the consumer and the firm side, in contrast to the
na¨ıve linear schedule.

_ℓ_ 1 **Penalty on Deviation from Baseline.** To retain policy
interpretability, we penalize the _planner_ for learning a tax
schedule _**τ**_ that deviates excessively from the naive baseline.
Specifically, we add an _ℓ_ 1 regularizer


_−_ 1

_B_ _[,]_ _[ b]_ _B_ _[j]_


_λ_


_B_
���� _τ_ _b_ _−_ _τ_ base _b_ ��� _,_

_b_ =1


where _λ ≥_ 0 tunes how much the planner is incentivized
to remain close to _τ_ [base] . Thus, the planner tweaks the naive
schedule only to the extent that it increases overall social
welfare. This can be interpreted as an “expert planner” capable of taking a known policy mechanism understood by
domain experts and adapting it to specific markets. The social planner’s full optimization problem is therefore


_B_
�

_b_ =1


�� _τ_ _b_ _−_ _τ_ base _b_ �� _._
�


max

_**τ**_


�


_W_ � _**τ**_ � _−_ _λ_


_._


Hence, while large deviations from the baseline _τ_ [base] are penalized, the planner retains the flexibility to adjust tax rates
to increase overall social welfare (e.g., by nudging firms toward more equitable pricing where the naive schedule is suboptimal).

**5.1** **Case Study 1: Health Insurance**
**Market Overview and Motivation.** Census data report

_∼_
7.9% of the U.S. working population uninsured ( 25M).
Though law-abiding insurance providers do not explicitly
use sensitive attributes in the determination of premia, these
can often be inferred from occupation and ZIP code (Dwork
et al. 2012; Barocas and Selbst 2016), making health insurance an ideal market for dynamic regulation. As mentioned,
this instance of our simulation represents a market for a necessity good, and thus we endow low-risk profiles with low
demand elasticity, and high-risk profiles with high demand
elasticity.

**Policy Generation and Empirical Results.** Use of our
method to regulate the health insurance market yields substantial welfare gains over benchmarks. We measure **net**
**profit** (after tax), **fairness**, and **social welfare** at both the
per-firm and global level. Table 3 ( _left_ ) shows the outcomes
under four market regimes: ( **Free Market** ) purely competitive, ( **Linear-SP** ) a simplistic bracket policy with fixed cutoffs, ( **RL-SP** ) our proposed social planner, and ( **Collusion** ),
a stable cartel-like coordination (used solely for revealing
an upper bound on profit from which we provide normalized profit values for the benchmarks of interest). From results, we note that the RL method achieved the highest social
welfare, not only by improving fairness, but also in improving total market profitability, indicating that it was able to
mitigate the social dilemma inherent to competitive games,
instead forcing firms into a kind of policy-induced tacit cooperation that makes the market more stable and friendly
to consumers. This is evidence that a fairness-seeking policy can outperform selfish Nash firms in terms of aggregate profits, suggesting that the RL policy might act as an
implicit coordination device, getting firms closer to the cooperative outcome without explicit collusion. Broadly, our
RL social planner improved social welfare in the market for
health insurance compared to the baseline competitive case
by approximately 11%, and outperformed the linear policy
by 10%. After 2M training steps, the RL social planner converged to the policy found in Figure 4a, with which, as seen
in Table 3 ( _left_ ), it was able to funnel firms into welfareimproving fairness brackets. Further, providing the agent
with an intuitive prior allowed it to maintain interpretability
in brackets with few or no training examples. Specifically,
it tweaked the Linear-SP baseline in fairness areas where it
was able to achieve substantial welfare gains.

**5.2** **Case Study 2: Consumer Credit**

**Market Overview and Motivation.** A second key application of our framework pertains to consumer credit, where
financial institutions offer loans or lines of credit to heterogeneous borrowers through competitive interest rates. Unlike health insurance, credit is generally less “essential” yet
the stakes remain high for consumers with limited collateral
or volatile income. For these groups, restricted credit access
can hamper opportunities to secure home equity, reinforcing
wealth gaps. As such, credit markets present a core tension
between risk-based pricing (necessary for profitable lending) and equitable access (necessary for social welfare and
fairness), making them an ideal testing ground for dynamic
regulation.

**Policy Generation and Empirical Results.** We evaluate
the outcomes of our credit market simulation across the
same four market regimes, though in this instance each assessed over five firms. In this market, we observe a qualitatively similar dynamic to the insurance scenario: the RL
social planner consistently improves upon linear policy interventions and competitive baselines, even in a setting with
greater firm heterogeneity and tighter fairness-profit tradeoffs. Evaluated over five competing lenders, Table 3 ( _right_ )
shows that the competitive market yields high profit levels


(a) Taxation policy generated by the RL social planner for the insurance market.

(b) Taxation policy generated by the RL social planner for the credit
market.

Figure 4: Comparison of policy generation across two different markets: Insurance (a) and Credit (b).

(0.630) but suffers from low fairness (0.660). The Linear-SP
baseline improves fairness to 0.712 but imposes a blunt restriction on risk-based interest rates, thereby driving down
profits and yielding modest improvements in participation.
By contrast, the RL policy exhibits adaptive behaviour,
learning market-specific bracket assignments that improve
fairness further (0.767) while also maintaining profitability
approaching that of the Free Market baseline. However, we
note an increase in the global opt-out rate under the RL policy, a result discussed further in the next section. Nonetheless, overall social welfare increases to 0.477, reversing the
decline observed under the Linear-SP baseline (0.392). This
represents social welfare gains of 15% and 22% over the
competitive and Linear-SP baselines, respectively.
Altogether, these results confirm that an RL-based regulator can foster an equilibrium where profitability and fairness
minimally conflict.

**6** **Discussion**

A notable aspect of our experiments is how tacit cooperation emerges within certain policy frameworks, evidenced
by how markets under the RL policy yield comparable or
even higher profits than under unregulated Free Market. This
is indicative of a social dilemma in unregulated Free Mar
**Insurance** **Credit**

**Free Market** **Linear-SP** **RL-SP** **Collusion** **Free Market** **Linear-SP** **RL-SP** **Collusion**

**Profit** _↑_ 0.697 0.642 0.707 _±_ 0.002 _1.0_ 0.630 0.551 _±_ 0.003 0.622 _±_ 0.003 _1.0_
**Fairness** _↑_ 0.821 0.895 0.895 _0.851_ 0.660 0.712 _±_ 0.006 0.767 _±_ 0.004 _0.709_
**Opt Out** _↓_ 0.137 0.120 0.121 _0.335_ 0.173 0.1593 _±_ 0.002 0.218 _±_ 0.002 _0.395_

**Welfare** 0.572 0.575 **0.633** _±_ **0.002** _0.851_ 0.416 0.392 _±_ 0.004 **0.477** _±_ **0.003** _0.709_

Table 3: Comparison of Profit, Fairness, and Welfare across market scenarios and dynamics. We include market-wide opt-out
rates to broadly outline market outcomes. Profit values are normalized with respect to the theoretical maximum determined by
the collusive (oracle) market setting. We report standard errors (SE) over 5 seeds, and omit SE values under 0.001.


ket: profit-maximizing individual firm behavior reduces aggregate profits. Meanwhile, by coordinating firm incentives,
the regulator resolves this inefficiency, while simultaneously
aligning firm and consumer welfare. Crucially, this “cooperation” among firms is driven not by explicit collusion, but
instead by an understanding of specific market dynamics acquired by the social planner, allowing it to design incentives
which mirror cooperation. From a policy perspective, these
insights suggest that partial regulation in the form of adaptive bracket constraints that do not artificially cap or flatten
prices can be more attractive than rigid price bounds or unregulated Free Market. This approach preserves profitability for firms while simultaneously broadening access and
mitigating discriminatory pricing. In practice, such bracket
tuning could be made transparent to both firms and policymakers, enabling oversight of how fairness categorizations
evolve over time.


actually outperforms Free Market in both markets, despite
yeilding the highest opt out rates by a substantial margin.
This is not because it truly encourages participation among
underrepresented groups, but because it simply makes all
consumers more equally _un_ likely to participate. This is evident from Figure 5, where we report group-level opt-out
rates. From these, we observe that this share is higher for
each subgroup under collusion. We note further that, under
the RL policy, there are reductions in opt-out rates among
the low-income group in both markets compared to Free
Market, albeit at the cost of an opt-out rate increase among
the high and middle-income groups. Thus, it is important
to examine resulting market distributions in order to qualitatively assess the impact of policy generations. Broadly,
while equal access is a desirable goal, it should not come
in the form of increased exclusion. A fairness criterion that
improves parity in access but leads to a larger number of
individuals being priced out or discouraged from participation can ultimately exacerbate structural harms and decrease overall social welfare. To alleviate this concern, one
might consider alternate metrics, such as consumer surplus
fairness (Cohen, Miao, and Wang 2021), which, when using our probabilistic setting, can be defined via the log-sum
rule (Small and Rosen 1981) as

��max _i_ _CS_ ( _**τ**_ ) _i_ _−_ min _k_ _CS_ ( _**τ**_ ) _k_ �� _≤_ _ϵ, ∀_ _i, k,_

where










|Col1|Col2|Col3|
|---|---|---|
||||
||||

|Col1|Col2|Col3|
|---|---|---|
||||

|Col1|Col2|Col3|
|---|---|---|
||||

|Col1|Col2|Col3|
|---|---|---|
||||
||||


_β_ [1] _i_ log�� _[N]_







exp ~~(~~ _α_ _j_ _−_ _β_ _i_ _p_ _i,j_ ) _._
�
_j_



_CS_ ( _**τ**_ ) _i_ = [1]

|Col1|Col2|
|---|---|
|||

|Col1|Col2|
|---|---|
|||

|Col1|Col2|Col3|
|---|---|---|
||||

|54|Col2|Col3|
|---|---|---|
||||
||||
||||


Free Market Linear-SP RL-SP Collusion

Figure 5: Mean consumer-group opt-out rates under multiple market frameworks. The arrow indicates the maximum
difference in opt-out rate means between population groups.
By global fairness, lower is better.

Despite obtaining welfare improvements with our RL
method, we deem it necessary to highlight a shortcoming regarding our fairness criterion. While demand fairness advocates for equal access to goods (as does _demographic parity_,
it is insufficient on its own at ensuring that consumer participation rates improve, as it simply requires that they be
agnostic to group membership, with no weight accorded to
their actual values. From Table 3, we find that fairness under **collusion**, an illicit market practice in most jurisdictions,


Accordingly, MarketSim makes it straightforward to swap
any welfare metric desired by the user and evaluate outcomes in terms of firm performance and consumer distribution.

**6.1** **Ablation Study: Market Bounds on Fairness**

While fairness, according to our local and global definitions,
has a theoretical upper bound of 1 _._ 0, the empirical upper
bound is largely dependent upon market dynamics and parameter initializations. Thus, to uncover the empirical upper
bounds on fairness in both markets, we train a new social
planner with the sole objective of maximizing global demand fairness with no weight on profit. Results reveal that
our instance of the market for insurance has an empirical upper bound on global fairness of 0 _._ 895, which was achieved

Insurance Credit

Firm A 0.947 0.823

Firm B 0.947 0.885

Firm C       - 0.793

Firm D       - 0.902

Firm E       - 0.763

Global 0.895 0.791

Table 4: Local and global fairness values under a fairnessmaximizing SP tax policy.

by both Linear-SP baselines and welfare-maximizing RL
policies. Meanwhile, in the credit market, our fairnessmaximizing SP reveals an empirical upper bound of 0 _._ 791,
which was approached but never achieved by our welfaremaximizing SP. This can influence the degree of improvement one can expect when experimenting with regulatory
frameworks in MarketSim.

**7** **Runtime & Scalability of MarketSim**

We explore runtimes to demonstrate the approximatelylinear scalability of price Free Market in MarketSim, reporting wall-clock convergence times on markets of 2 to
100 firms. As the number of participating firms may vary
between markets, our simulation should scale well over a
broad range of firm counts. For instance, 80% the U.S.

5

4

3

2

1

0

0 20 40 60 80 100

Number of Firms

Figure 6: Mean wall-clock runtime per 10 rounds as a function of the number of firms (on CPU). Error bars represent
standard deviation over 5 seeds.

health insurance market is dominated by 10 firms, with 57%
concentrated in the top 3 (American Medical Association
2023). Meanwhile, the credit market is more fragmented,
with many non-bank lenders making up 65% of the mortgage lending market (Chopra 2024). Conversely, 70% of
the credit card market is dominated by 5 issuers (McCann
2025), indicating a broader range for participation within
lending markets. MarketSim nonetheless accommodates
arbitrarily many firms and consumers, with runtimes scaling
linearly.

**Limitations and Future Work.** While these findings offer promising evidence, we highlight several directions for
further inquiry:


1. **Multi-step Taxation Dynamics:** While this work focused on a single-step taxation policy, an exciting direction for future research is to frame taxation as a sequential decision-making task. Such settings could further emphasize the advantages of RL approaches.
2. **Data Quality and Bias:** Real-world transactional
datasets often contain inaccuracies, missing fields, or historical biases, which could skew bracket assignments. Investigating robustness under such conditions remains an
essential next step.
3. **Bracket Design:** We implement a straightforward
bracket structure here. Future work might explore more
sophisticated, flexible brackets or alternative reward
functions that accommodate multiple fairness definitions
or risk preferences.
4. **Legal and Ethical Context:** As bracketed interventions
shape competitive behavior at scale, deeper analysis is
warranted to confirm compatibility with antitrust laws
and to guard against new forms of collusion or bias.

In summary, our case studies demonstrate that dynamic
bracket regulation can notably enhance fairness and welfare
in a competitive market scenario feature dynamic pricing
with heterogeneous firms and consumer profiles. By aligning private incentives with public interest goals, RL-driven
brackets exemplify a viable pathway toward more inclusive
market systems for essential products and services.

**8** **Conclusion**

In this work, we explore social welfare outcomes under various policy mechanisms in markets featuring risk-based dynamic pricing. We mathematically demonstrate the relationship between local and global notions of fairness, thereby
motivating a firm-level policy approach. We then introduce
MarketSim, a simulator for risk-based dynamic pricing,
which we render open-source. Finally, we reproduce two
distinct real world markets where global opt-out gaps have
been empirically recorded (health insurance and consumer
credit) and demonstrate how RL can be successfully leveraged to generate interpretable policy mechanisms aimed at
improving social welfare.

**9** **Ethical Statement**

If rigorously validated and overseen, AI-assisted regulation
could help align private incentives with societal fairness
goals in essential-goods markets (e.g. health insurance, consumer credit). Conversely, careless application risks legitimising opaque pricing schemes and deepening existing disparities. We urge future work to prioritise transparency, multidisciplinary oversight, and the voices of affected communities.

**Acknowledgements**

Funding support for project activities has been partially
provided by Canada CIFAR AI Chair, Google award, and
FRQNT scholarships. We also express our gratitude to Compute Canada and Mila clusters for their support in providing
facilities for our evaluations.

**References**

Achiam, J.; Held, D.; Tamar, A.; and Abbeel, P. 2017. Constrained policy optimization. In _Proceedings of the 34th_
_International Conference on Machine Learning_, ICML ’17,
22–31. JMLR.org.
American Medical Association. 2023. AMA identifies market leaders in health insurance. Accessed: 2025-04-19.

Barocas, S.; and Selbst, A. D. 2016. Big data’s disparate
impact. _California Law Review_, 104(3): 671–732.
Becker, G. S. 1962. Irrational behavior and economic theory.
_Journal of political economy_, 70(1): 1–13.
Ben-Akiva, M.; McFadden, D.; Train, K.; Walker, J.; Bhat,
C.; Bierlaire, M.; Bolduc, D.; Boersch-Supan, A.; Brownstone, D.; Bunch, D. S.; et al. 2002. Hybrid choice models:
Progress and challenges. _Marketing Letters_, 13: 163–175.
Berry, S. T.; Levinsohn, J. A.; and Pakes, A. 1993. Automobile prices in market equilibrium: Part I and II.
Bertoletti, L.; Borraz, F.; and Sanroman, G. 2024. Consumer
Debt and Poverty: the Default Risk Gap. Technical report,
GLO Discussion Paper.
Bertsimas, D.; Farias, V. F.; and Trichakis, N. 2011. The
price of fairness. _Operations research_, 59(1): 17–31.
Betancourt, J. M.; Hortac¸su, A.; Oery, A.; and Williams,
K. R. 2022. Dynamic price competition: Theory and evidence from airline markets. Technical report, National Bureau of Economic Research.

Chopra, R. 2024. Statement by CFPB Director Rohit Chopra
on the Financial Stability Oversight Council’s Nonbank
Mortgage Company Report. Accessed: 2025-04-21.
Cohen, M. C.; Elmachtoub, A. N.; and Lei, X. 2022. Price
discrimination with fairness constraints. _Management Sci-_
_ence_, 68(12): 8536–8552.
Cohen, M. C.; Miao, S.; and Wang, Y. 2021. Dynamic pricing with fairness constraints. _Available at SSRN 3930622_ .
Das, S.; Dhamal, S.; Ghalme, G.; Jain, S.; and Gujar,
S. 2022. Individual fairness in feature-based pricing for
monopoly markets. In _Uncertainty in Artificial Intelligence_,
486–495. PMLR.

Dwork, C.; Hardt, M.; Pitassi, T.; Reingold, O.; and Zemel,
R. 2012. Fairness through awareness. In _Proceedings of the_
_3rd innovations in theoretical computer science conference_,
214–226.

Fleurbaey, M. 2008. _Fairness, responsibility, and welfare_ .
OUP Oxford.

Fout, H.; Li, G.; Palim, M.; and Pan, Y. 2020. Credit risk of
low income mortgages. _Regional Science and Urban Eco-_
_nomics_, 80: 103390.

Gallego, G.; Topaloglu, H.; et al. 2019. _Revenue manage-_
_ment and pricing analytics_, volume 209. Springer.
Garcıa, J.; and Fern´andez, F. 2015. A comprehensive survey
on safe reinforcement learning. _Journal of Machine Learn-_
_ing Research_, 16(1): 1437–1480.
Haarnoja, T.; Zhou, A.; Hartikainen, K.; Tucker, G.; Ha,
S.; Tan, J.; Kumar, V.; Zhu, H.; Gupta, A.; Abbeel, P.; and
Levine, S. 2018. Soft Actor-Critic Algorithms and Applications.


Kallus, N.; and Zhou, A. 2021. Fairness, welfare, and equity
in personalized pricing. In _Proceedings of the 2021 ACM_
_conference on fairness, accountability, and transparency_,
296–314.

Keisler-Starkey, K.; Bunch, L. N.; and Lindstrom, R. 2024.
Health Insurance Coverage in the United States: 2023.
Lee, S.; Illia, A.; and Lawson-Body, A. 2011. Perceived
price fairness of dynamic pricing. _Industrial Management_
_& Data Systems_ .
Maestre, R.; Duque, J.; Rubio, A.; and Ar´evalo, J. 2019. Reinforcement learning for fair dynamic pricing. In _Intelligent_
_Systems and Applications: Proceedings of the 2018 Intel-_
_ligent Systems Conference (IntelliSys) Volume 1_, 120–135.
Springer.
Martinez, M. E. 2022. QuickStats: Percentage of Uninsured Adults Aged 18–64 Years, by Race and Selected Hispanic Origin Subgroup — National Health Interview Survey,
United States, 2020. _MMWR Morb Mortal Wkly Rep 2022_,
71(834).
McCann, A. 2025. Credit Card Market Share by Issuer. Accessed: 2025-04-19.

McFadden, D. 1972. Conditional logit analysis of qualitative
choice behavior.

Nicholson, V. J.; Bunn, T. L.; and Costich, J. F. 2008. Disparities in work-related injuries associated with worker compensation coverage status. _American journal of industrial_
_medicine_, 51(6): 393–398.
Pew Research Center. 2024. Are you in the American middle class? [Accessed: 2025-02-28].
Powell, M. J. 1964. An efficient method for finding the minimum of a function of several variables without calculating
derivatives. _The computer journal_, 7(2): 155–162.
Schlosser, R.; and Boissier, M. 2018. Dynamic pricing under competition on online marketplaces: A data-driven approach. In _Proceedings of the 24th ACM SIGKDD interna-_
_tional conference on knowledge discovery & data mining_,
705–714.

Small, K. A.; and Rosen, H. S. 1981. Applied welfare economics with discrete choice models. _Econometrica: Journal_
_of the Econometric Society_, 105–130.
U.S. Census Bureau. 2023. Homeownership by Race and
Ethnicity of Householder. https://www.census.gov/library/
visualizations/interactive/homeownership-by-race-andethnicity-of-householder.html. Interactive visualization,
released September 28, 2023. Accessed April 29, 2025.
Virtanen, P.; Gommers, R.; Oliphant, T. E.; Haberland,
M.; Reddy, T.; Cournapeau, D.; Burovski, E.; Peterson, P.;
Weckesser, W.; Bright, J.; et al. 2020. SciPy 1.0: fundamental algorithms for scientific computing in Python. _Nature_
_methods_, 17(3): 261–272.
Wang, Q.; Huang, Y.; Singh, P. V.; and Srinivasan, K. 2023.
Algorithms, artificial intelligence and simple rule based
pricing. _Available at SSRN 4144905_ .
Zheng, S.; Trott, A.; Srinivasa, S.; Naik, N.; Gruesbeck, M.;
Parkes, D. C.; and Socher, R. 2020. The ai economist: Improving equality and productivity with ai-driven tax policies.
_arXiv preprint arXiv:2004.13332_ .

Zhu, Y.; Yuan, Y.; Gu, J.; and Fu, Q. 2023. Neoliberalization
and inequality: disparities in access to affordable housing in
urban Canada 1981–2016. _Housing Studies_, 38(10): 1860–
1887.

**A** **Price Convergence in Insurance**
**Simulation**

Firms converge to different price allocations dependent upon
the market dynamics. Under fairness incentives (linear and
RL policies), firms are nudged to adopt lower prices for the
low income group than under Free Market. When firms collude, they set prices much higher to maximize total market
profits.

Insurance Premia Convergence

20

15

10

5

0

Free Market Linear-SP RL Collusion

_P_ _low_ _[A]_ _P_ _middle_ _[A]_ _P_ _hi_ _[A]_ _gh_
_P_ _low_ _[B]_ _P_ _middle_ _[B]_ _P_ _high_ _[B]_

We note that the RL policy leads firms to converge to
prices similar to those resulting from the linear policy.
This is likely due to these fairness brackets being optimal,
as uncovered in Section 6.1. However, the SP is able to
improve welfare further by lowering taxes in those brackets,
allowing firms to keep more of their profit for achieving
optimal fairness.

**B** **A Probabilistic Bound on Global Fairness**

With more assumptions, we derive a tighter, albeit probabilistic bound on opt-out gaps as a result of bounds on local

gaps.
**Proposition 2** (Local fairness _⇒_ global fairness) **.** _We wish_
_to bound, with high probability, the deviation_
�� Pr( _F_ = 0 _| A_ = _i_ ) _−_ Pr( _F_ = 0 _| A_ = _k_ )��


**a) Hoeffding’s Inequality (bounded differences)** _Be-_
_cause the X_ _j_ _’s are bounded in_ [ _−ϵ, ϵ_ ] _, Hoeffding’s inequal-_
_ity gives, for a candidate bound t,_

Pr���� _Nj_ =1 _[X]_ _[j]_ �� _≥_ _t_ � _≤_ 2 exp� _−_ _N_ (22 _t_ [2] _ϵ_ ) [2] � _._


This Hoeffding bound, while not a convergence guarantee, is
sufficient to demonstrate the tight relationship between local
and global fairness.

**C** **SAC Hyperparameters**

We outline the hyperparameters used with SAC to train
our Social Planner agent. They are the same as the default hyperparameters encouraged by Haarnoja et al. (2018).
**SAC Hyperparameters**

**Hyperparameters**

Hidden-layer sizes (actor/critic) [256 _,_ 256]
Activation function ReLU
Learning rate _η_ 0 _._ 0003
Batch size 256
Replay-buffer size 1 _M_
Discount factor _γ_ 0 _._ 00 (RL)
Target-update coef. _τ_ soft 0 _._ 005
Entropy coef. _α_ ent _auto_
Updates per env step 1
Warm-up steps 100
Total training steps 2 _M_
Random seed [0 _,_ 1 _,_ 2 _,_ 3 _,_ 4]


_Setting t_ = 2 _ϵ_
�


_N_


_N_ 2

2 [log] � _δ_


_Setting t_ = 2 _ϵ_ � _N_ 2 [log] � 2 _δ_ � _yields, with probability at least_

1 _−_ _δ,_


_N_
�

_j_ =1


(1)


���


� _P_ ( _F_ = _j | A_ = _k_ ) _−_ _P_ ( _F_ = _j | A_ = _i_ )� [�]
��


_≤_ 2 _ϵ_


~~�~~


_N_ 2

2 [log] � _δ_ � _._


**b) Bernstein’s Inequality (variance information avail-**
**able)** _If in addition_ Var[ _X_ _j_ ] _≤_ _σ_ [2] _, Bernstein’s inequality_
_states_


Pr���� _Nj_ =1 _[X]_ _[j]_ �� _≥_ _t_ � _≤_ 2 exp� _−_ 2 _Nσ_ [2] _t_ [2]


3 _[ϵ t]_


2 _Nσ_ [2] + [2]


_,_
�


_which can be tighter when most differences are very small_
_(i.e. σ_ [2] _≪_ _ϵ_ [2] _)._

**High–Probability Bound** _From_ (1) _, we conclude that,_
_with probability at least_ 1 _−_ _δ,_

�� Pr( _F_ = 0 _| A_ = _i_ ) _−_ Pr( _F_ = 0 _| A_ = _k_ )�� _≤_


2 _ϵ_


�


_N_ 2

2 [log] � _δ_ � _._


_N_
��Pr( _F_ = _j | A_ = _k_ ) _−_ Pr( _F_ = _j | A_ = _i_ )�

_j_ =1 ������


=


������


=
���


_N_
� _X_ _j_ ��� _,_

_j_ =1


_where we set the random variables_
_X_ _j_ := Pr( _F_ = _j | A_ = _k_ ) _−_ Pr( _F_ = _j | A_ = _i_ ) _,_
_j_ = 1 _, . . ., N._

_**Assumptions.**_

_1. The variables {X_ _j_ _}_ _[N]_ _j_ =1 _[are independent.]_
_2. Each X_ _j_ _is bounded: |X_ _j_ _| ≤_ _ϵ._
_3. Optionally,_ Var[ _X_ _j_ ] _≤_ _σ_ [2] _(needed only for Bernstein)._

